# å¦‚ä½•å†™ä¸€ä¸ªç°ä»£çš„javascriptåº“

å¸®åŠ©å¤§å®¶èƒ½å¤Ÿå¿«é€Ÿå­¦ä¹ ï¼Œå¦‚ä½•æ­å»ºä¸€ä¸ªæ ‡å‡†çš„javascriptåº“ï¼Œåˆ›å»ºä¸€ä¸ªå¼€æºåº“éƒ½éœ€è¦å“ªäº›ä¸œè¥¿ç­‰

è‡³äºåšä¸ªä»€ä¹ˆæ ·çš„å¼€æºé¡¹ç›®ï¼Œä½ è‡ªå·±ç©å§ï¼ï¼ï¼ï¼Œæ¨è[è¿™é‡Œ](http://blog.jobbole.com/113602/)ç§¯ç´¯ä¸‹ç»éªŒå§

æ ‡å‡†çš„javascriptåº“éƒ½åŒ…å«å“ªäº›ä¸œè¥¿
- æ–‡æ¡£
- æµ‹è¯•ç”¨ä¾‹
- demo
- è‡ªåŠ¨åŒ–æ„å»ºï¼Œå‘å¸ƒç­‰
- è§„èŒƒ

## ç¬¬ä¸€æ­¥ æ–‡æ¡£

æ ‡å‡†çš„é¡¹ç›®æ–‡æ¡£åº”è¯¥åŒ…å«å¦‚ä¸‹

- README.md
- TODO.md
- CHANGELOG.md
- LICENSE
- doc

![](./images/doc.png)

### README.md

`README.md`READMEæ˜¯ä¸€ä¸ªé¡¹ç›®çš„é—¨é¢ï¼Œåº”è¯¥ç®€å•æ˜äº†çš„å‘ˆç°ç”¨æˆ·æœ€å…³å¿ƒçš„é—®é¢˜ï¼Œä¸€ä¸ªå¼€æºåº“çš„ç”¨æˆ·åŒ…æ‹¬`ä½¿ç”¨è€…`å’Œ`è´¡çŒ®è€…`ï¼Œæ‰€ä»¥ä¸€ä¸ªæ–‡æ¡£åº”è¯¥åŒ…æ‹¬`é¡¹ç›®ç®€ä»‹`ï¼Œ`ä½¿ç”¨è€…æŒ‡å—`ï¼Œ`è´¡çŒ®è€…æŒ‡å—`ï¼Œ`ä»£ç ç»„ç»‡æ¶æ„`ç­‰å‡ ä¸ªéƒ¨åˆ†ï¼Œ

å¦‚æœä½ çš„`README`åŒ…æ‹¬ä¸Šé¢çš„å†…å®¹,é‚£ä¹ˆå½“ä½¿ç”¨è€…æ‹¿åˆ°ä»£ç ,æ‰“å¼€`README`å,åŸºæœ¬å°±çŸ¥é“è¯¥å¦‚ä½•ä¸‹æ‰‹äº†

ç¾è§‚ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä¸‹é¢ä»‹ç»ä¸‹å¾½ç« ï¼Œ[å¦‚ä½•åˆ¶ä½œå¾½ç« ](https://shields.io/#/)ï¼Œå¸¸ç”¨çš„å¾½æ ‡ä¸»è¦æœ‰æŒç»­é›†æˆçŠ¶æ€ã€é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ã€ä»£ç æµ‹è¯•è¦†ç›–ç‡ã€é¡¹ç›®æ”¯æŒå¹³å°ã€é¡¹ç›®è¯­è¨€ã€ä»£ç åˆ†æç­‰ï¼Œ[å‚è€ƒ](https://juejin.im/post/5a32157c6fb9a0450b6667ac)

### TODO.md

`TODO`åº”è¯¥è®°å½•é¡¹ç›®çš„è®¡åˆ’ï¼Œè¿™å¯¹äºè´¡çŒ®è€…å’Œä½¿ç”¨è€…éƒ½æœ‰å¾ˆé‡è¦çš„æ„ä¹‰ï¼Œä¸‹é¢æ˜¯TODOçš„ä¾‹å­
```
- [x] åŠŸèƒ½ä¸€
- [ ] åŠŸèƒ½äºŒ
```
### CHANGELOG.md
`CHANGELOG.md`è®°å½•é¡¹ç›®çš„å˜æ›´æ—¥å¿—ï¼Œæ¯æ¬¡å‡çº§å‘å¸ƒçš„æ—¶å€™ï¼Œéƒ½è¦è®°å½•é¡¹ç›®çš„ç‰ˆæœ¬ï¼Œå‘å¸ƒæ—¶é—´ï¼Œå˜æ›´å†…å®¹ç­‰

### LICENSE
å¼€æºé¡¹ç›®å¿…é¡»è¦é€‰æ‹©ä¸€ä¸ªåè®®ï¼Œå› ä¸ºæ²¡æœ‰åè®®çš„é¡¹ç›®æ˜¯æ²¡æœ‰äººæ•¢ä½¿ç”¨çš„ï¼Œ[å‚è€ƒè¿™é‡Œ](https://spdx.org/licenses/)ï¼Œå¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ­£ç¡®çš„å¼€æºè®¸å¯ï¼Ÿ[å‚è€ƒè¿™é‡Œ](https://blog.csdn.net/j01g58uc80251/article/details/78131010)ï¼Œå»ºè®®æ˜¯é€‰æ‹©MITå’ŒBSDåè®®

![](./images/license.png)

### DOC
è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£ï¼Œä¸€ä»½è¯¦ç»†çš„æ–‡æ¡£åº”è¯¥ï¼š
- åŠŸèƒ½çš„è¯¦ç»†ä»‹ç»
- ä½¿ç”¨æ–¹æ³•çš„è¯¦ç»†ä»‹ç»
- ä»£ç ç”¨ä¾‹
- ç‰¹æ®Šè¯´æ˜ç­‰

## ç¬¬äºŒæ­¥ æ„å»ºå·¥ç¨‹
ä¸€ä¸ªå·¥ç¨‹çš„æ„å»ºè¿‡ç¨‹åŒ…æ‹¬ç¼–è¯‘ï¼Œæ‰“åŒ…ï¼Œå‹ç¼©ï¼Œæµ‹è¯•ç­‰ä¸€åˆ‡å¯¹æºç è¿›è¡Œçš„ç›¸å…³å¤„ç†

### ç¼–è¯‘
ç†æƒ³æƒ…å†µä¸‹ï¼Œå¼€å‘è€…å¼€å¿ƒçš„å†™es6+çš„ä»£ç ï¼Œç„¶åèƒ½å¤Ÿè¿è¡Œåœ¨nodeå’Œæµè§ˆå™¨ç«¯ï¼Œå…¼å®¹ç”¨æˆ·çš„AMDå’ŒCMDæ¨¡å—æ–¹æ¡ˆï¼Œç”¨æˆ·èƒ½é¡ºåˆ©åº”ç”¨èµ·æ¥ã€‚ç†æƒ³æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œä½†æ˜¯å¦‚ä½•æ‰èƒ½ä½¿å¼€å‘è€…å’Œç”¨æˆ·éƒ½èƒ½å¼€å¿ƒå‘¢ï¼Ÿè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯`babel v7`ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯æœ€æ–°çš„ç°ä»£åŒ–çš„`@babel/preset-env`
```bash
$ npm install @babel/preset-env -D
```
ç„¶ååœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª`.babelrc`æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®
```js
{
  "presets": [
    [
      "@babel/env",
      {
        "modules": false,
        "targets": {
          "browsers": "last 2 versions, > 1%, Android >= 4.1, IOS >= 9,  Chrome >= 16",
          "node": "6.14.0"
        }
      }
    ]
  ]
}
```
babelçš„é…ç½®å¯ä»¥[å‚è€ƒè¿™é‡Œ](https://babeljs.io/docs/en/babel-preset-env#install)ï¼Œbabelæœ€æ–°ç‰ˆ`@babel/preset-env`å¯ä»¥ä½¿å¼€å‘è€…ï¼Œç”¨æœ€æ–°çš„jsè¯­æ³•ç‰¹æ€§ï¼Œè€Œä¸”æ— éœ€å…³å¿ƒå¯¹ç”¨æˆ·ç¯å¢ƒåšè½¬æ¢ï¼ˆæ¯”å¦‚å¼•å…¥ browser polyfillsï¼‰ï¼Œ

### æ‰“åŒ…
ç¼–è¯‘è§£å†³äº†ES6åˆ°ES5çš„é—®é¢˜ï¼Œæ‰“åŒ…å¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€çš„æ–‡ä»¶å…¥å£ï¼Œæ‰“åŒ…è§£å†³çš„æ˜¯ä¾èµ–å¼•å…¥çš„é—®é¢˜ã€‚å½“ä¸‹æ¯”è¾ƒæµè¡Œçš„æ‰“åŒ…ç¼–è¯‘å·¥å…·æœ‰gulpï¼Œrollupï¼Œwebpackç­‰ã€‚å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿæ¨èä¸¤ä¸ªæ¯”è¾ƒæµè¡Œçš„`rollup`å’Œ`webpack`ï¼ŒäºŒè€…ä¸»è¦åŒºåˆ«ï¼š çº¯jsåº“ä½¿ç”¨`rollup`ï¼Œå…¶ä»–åœºæ™¯ä½¿ç”¨`webpack`, rollupæ‰“åŒ…åï¼Œæ²¡æœ‰å¾ˆå¤šå†—æ‚çš„ä»£ç ï¼Œç„¶è€Œwebpackæœ‰ï¼Œ[rollupæ–‡æ¡£](https://www.rollupjs.com/guide/zh#babel)ï¼Œ[webpackæ–‡æ¡£](https://www.webpackjs.com/)ï¼Œä¸‹é¢æ˜¯ä»‹ç»ä¸‹rollup

#### [rollupä»‹ç»](https://www.rollupjs.com/guide/zh#babel)
ä½œä¸ºä¸‹ä¸€ä»£æ‰“åŒ…åˆ©å™¨ï¼Œé€šè¿‡Tree-shackingçš„æ–¹å¼æ¥å‰”é™¤å„æ¨¡å—ä¸­æœ€ç»ˆæœªè¢«å¼•ç”¨åˆ°çš„æ–¹æ³•ï¼Œé€šè¿‡ä»…ä¿ç•™è¢«è°ƒç”¨åˆ°çš„ä»£ç å—æ¥ç¼©å‡æ‰“åŒ…æ–‡ä»¶çš„å¤§å°

#### ä½¿ç”¨æ–¹å¼
```bash
$ npm install rollup -D 
```

æ‰“åŒ…æ–¹å¼ç®€å•ç²—æš´ï¼Œç›´æ¥`rollup src/main.js -o dist/bundle.js -f cjs`ï¼ˆè£…äº†å…¨å±€çš„rollupæ‰å¯ä»¥ç”¨`rollup`å‘½ä»¤ğŸ˜¯ï¼‰ï¼Œå°±å¯ä»¥æ‰“åŒ…äº†ã€‚å’Œ webpack ä¸€æ ·ï¼Œrollup ä¹Ÿæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶æ¥å®ç°æ›´çµæ´»çš„åŠŸèƒ½

```js
import babel from 'rollup-plugin-babel'

import {name, banner} from './rollup'

export default {
  input: 'src/index.js', // å…¥å£æ–‡ä»¶
  output: {
    file: 'dist/index.js', // è¾“å‡ºçš„æ–‡ä»¶ (å¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œåˆ™ç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°)
    format: 'cjs', // è¾“å‡ºçš„æ–‡ä»¶ç±»å‹ (amd, cjs, es, iife, umd)
    banner, // æ‰“åŒ…åä»£ç çš„æ³¨é‡Šå¤´
    name, // ç”ŸæˆUMDæ¨¡å—çš„åå­—
  },
  plugins: [ // æ’ä»¶
    babel({
      runtimeHelpers: true,
      exclude: 'node_modules/**',
    }),
  ],
}
```

ç„¶åæ‰§è¡Œ
```
$ rollup -c
```
å³å¯é€šè¿‡é»˜è®¤é…ç½®æ–‡ä»¶ï¼ˆrollup.config.jsï¼‰æ‰€è®¾ç½®çš„ä¿¡æ¯æ¥è¿›è¡Œæ‰“åŒ…ã€‚ä¹Ÿå¯ä»¥
```
$ rollup -c xxxx/xxx.js
```
å¦‚æœä¸æƒ³è£…å…¨å±€çš„åœ¨package.jsonä¸­æ·»åŠ scriptå³å¯,æ¯”å¦‚ï¼š
```js
"scripts" : {
  "lint": "eslint -c .eslintrc.js src",
  "clean": "rm -rf ./dist",
  "build": " npm run clean && rollup -c config/rollup.config.js && rollup -c config/rollup.config.aio.js && rollup -c config/rollup.config.esm.js",
  "test": "npm run lint && npm run build && mocha",
  "release": "npm test && git commit -am $npm_package-version && git tag $npm_package_version && git push && git push --tags"
}
```
æ‰§è¡Œ
```bash
$ npm run build
```

## ç¬¬ä¸‰æ­¥ è§„èŒƒ
æ— è§„çŸ©å•¥ä¹Ÿä¸æˆï¼Œç‰¹åˆ«æ˜¯å¼€æºçš„é¡¹ç›®ï¼Œä¼šæœ‰å…¶ä»–è´¡çŒ®è€…å‚ä¸ï¼Œé•¿æ—¶é—´ä¸€èµ·danç–¼

### ç¼–è¾‘å™¨è§„èŒƒ
é¦–å…ˆå¯ä»¥é€šè¿‡`.editorconfig`æ¥ä¿è¯ç¼©è¿›ã€æ¢è¡Œçš„ä¸€è‡´æ€§ï¼Œç­‰ç­‰å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä»–[å‚è€ƒè¿™é‡Œ](https://editorconfig.org/)
```js
root = true

[{*.js,*.css,*.html}]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
insert_final_newline = true

[{package.json,.*rc,*.yml}]
indent_style = space
indent_size = 2

```

### ä»£ç é£æ ¼
é€šè¿‡eslintæ¥ä¿è¯ä»£ç é£æ ¼ä¸€è‡´ï¼Œåˆ›å»º`.eslintrc.js`æ–‡ä»¶ï¼Œå…·ä½“é…ç½®å‚è€ƒ[`eslint API`](https://cn.eslint.org/)
```js
"scripts": {
    "lint": "eslint -c .eslintrc.js src",
  },
```
å‡†å¤‡å‘å¸ƒä¹‹å‰ï¼Œæ‰§è¡Œ `npm run lint`æ¥æ£€æŸ¥ä»£ç 

### è®¾è®¡è§„èŒƒ
è‰¯å¥½çš„ç¼–ç¨‹è§„èŒƒå¯¹äºè½¯ä»¶çš„å¼€å‘ä¸ç»´æŠ¤ï¼Œè‡³å…³é‡è¦ï¼ä»–ä¸ä»…å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯é æ€§ã€æœ‰æ•ˆæ€§ã€å¥å£®æ€§ï¼Œè€Œä¸”åˆ©äºå¸®åŠ©å¼€å‘äººå‘˜å¼€å‘å’Œç»´æŠ¤ä»£ç ã€‚
- å‘½åè§„èŒƒ
- æ³¨é‡Šè§„èŒƒ
- å‡½æ•°ç¼–ç è§„èŒƒ
- é”™è¯¯å¤„ç†è§„èŒƒ
- xxxxè§„èŒƒ

æ¯”å¦‚å‘½åçš„è®¾è®¡è§„èŒƒï¼Œç»™å‡ºä¸€äº›å»ºè®®ï¼Œä¹Ÿå¯å‚è€ƒ[JavaScriptç¼–ç é£æ ¼](http://www.ruanyifeng.com/blog/2012/04/javascript_programming_style.html)
- ä½¿ç”¨å¯ä»¥å‡†ç¡®è¯´æ˜å˜é‡ã€å‡½æ•°ã€åŸå‹(prototype)çš„å®Œæ•´è‹±æ–‡æè¿°ç¬¦ã€‚ä¸¥ç¦ä½¿ç”¨æ±‰è¯­æ‹¼éŸ³ã€ä¸ç›¸å…³å•è¯åŠæ±‰å­—è¿›è¡Œå‘½å
- å°½é‡å°‘ç”¨ç¼©å†™ï¼Œä½†å¦‚æœä¸€å®šè¦ä½¿ç”¨æˆ–åç§°è¿‡é•¿ï¼ˆä¸è¶…è¿‡ 25 ä¸ªå­—æ¯ï¼‰ï¼Œå½“ä½¿ç”¨å…¬å…±ç¼©å†™å’Œä¹ æƒ¯ç¼©å†™ç­‰ï¼Œå¦‚å®ç°ï¼ˆimplementï¼‰å¯ç¼©å†™æˆimplï¼Œç»ç†ï¼ˆmanagerï¼‰å¯ç¼©å†™æˆmgrç­‰ï¼Œä¸¥ç¦æ»¥ç”¨ç¼©å†™
- å˜é‡éµå¾ªé©¼å³°å‘½åè§„åˆ™
- ç±»åã€æ„é€ å‡½æ•°ã€å…¬å…±å¯¹è±¡å®ä¾‹ç­‰åç§°é¦–å­—æ¯å¤§å†™ã€‚
- å…¨å±€å˜é‡ã€å¸¸é‡åº”è¯¥å…¨éƒ¨å¤§å†™ï¼›

### ç‰ˆæœ¬è§„èŒƒ
éµå¾ªå¼€æºç¤¾åŒºé€šç”¨çš„[`è¯­ä¹‰åŒ–ç‰ˆæœ¬`](https://semver.org/lang/zh-CN/)
ç‰ˆæœ¬æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼Œè§„åˆ™å¦‚ä¸‹
- ä¸»ç‰ˆæœ¬å·ï¼š å½“ä½ åšäº†ä¸å…¼å®¹çš„APIä¿®æ”¹
- æ¬¡ç‰ˆæœ¬å·ï¼š å½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- ä¿®è®¢å·ï¼š å½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

### æäº¤commitè§„èŒƒ
å‚è€ƒä¸€å³°çš„åšå®¢[Commit message å’Œ Change log ç¼–å†™æŒ‡å—](http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html)

## æµ‹è¯•
æµ‹è¯•ä¿è¯ä»£ç çš„è´¨é‡ï¼Œæ²¡æœ‰å•å…ƒæµ‹è¯•ï¼Œä¿®æ”¹å®Œä½ æœ‰åº•æ°”å‘å¸ƒå—ï¼Ÿï¼Ÿï¼Ÿæ¨èä½¿ç”¨`Mocha`æµ‹è¯•åº“ï¼Œå¯å‚è€ƒ[æµ‹è¯•æ¡†æ¶ Mocha å®ä¾‹æ•™ç¨‹](http://www.ruanyifeng.com/blog/2015/12/a-mocha-tutorial-of-examples.html),ä¸¾ä¸ªä¾‹å­ğŸŒ°
```js
var expect = require('expect.js');

describe('å•å…ƒæµ‹è¯•', function() {
    describe('åŠŸèƒ½1', function() {
        it('ç›¸ç­‰', function() {
            expect(1).to.equal(1);
        });
    });
});
```
ç„¶ååªéœ€è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œmochaä¼šè‡ªåŠ¨è¿è¡Œtestç›®å½•ä¸‹é¢çš„jsæ–‡ä»¶
```bash
$ mocha
```

## å¯æŒç»­é›†æˆ
æ²¡æœ‰å¯æŒç»­é›†æˆçš„åº“éƒ½æ˜¯åŸå§‹äººï¼Œå¦‚æœæ¯æ¬¡pushéƒ½èƒ½å¤Ÿè‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•å°±å¥½äº†ï¼Œè¿™æ ·å°±çœå»äº†æ‰‹åŠ¨è¿è¡Œçš„ç¹çï¼Œå¥½åœ¨[travis-ci](https://www.travis-ci.org/)å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½¿ç”¨å¯å‚è€ƒ[æŒç»­é›†æˆæœåŠ¡ Travis CI æ•™ç¨‹](http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html)

![](./images/travis.png)

